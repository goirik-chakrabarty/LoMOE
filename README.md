## LoMOE : LoMOE: Localized Multi-Object Editing via Multi-Diffusion

![alt text](logo.png "lomoe")

## Description
`lomoe` contains an implementation of an algorithm to edit _multiple objects_ in a _single pass_ using a diffusion model. All the code has been written in [Python 3](https://www.python.org).

## Environment
```
conda create -n lomoe python=3.9
conda install pytorch==2.0.1 torchvision==0.15.2 pytorch-cuda=11.7 -c pytorch -c nvidia
pip install accelerate==0.20.3 diffusers==0.12.1 einops==0.7.0 ipython transformers==4.26.1 salesforce-lavis==1.0.2
```

## Organisation of the `lomoe` repository

* `./benchmark`
    - `methods/`
        - `bld/`        -> [[1]](https://github.com/ermongroup/SDEdit)
        - `diffedit/`
        - `glide/`      -> [[2]](https://github.com/openai/glide-text2im)
        - `instruct-p2p`

    - `metrics/`
        - `MOE/`
        - `SOE/`

* `./data`
    - `LoMOE_Bench/`
        - `images/`
        - `masks/`
        - `LoMOE.json`

    - `LoSOE_Bench/`
        - `images/`
        - `masks/`
        - `LoSOE.json`

* `./lomoe`
    - `edit/`
        - `utils.py`
        - `main.py`
    - `invert/`
        - `src/`
        - `run_multi.py` -> rename
        - `run.py`  -> merge
        - `run2.py` -> merge
    - `sample/` -> enter image-mask pairs here 
    - `output/` -> autogenerated

## Usage

For running LoMOE for custom edits, `cd lomoe` and find it's `README.md`.

## Authors
* Anonymous.

## References
<a id="1">[1]</a> 
Meng, C., He, Y., Song, Y., Song, J., Wu, J., Zhu, J., & Ermon, S. (2021). SDEdit: Guided Image Synthesis and Editing with Stochastic Differential Equations. International Conference on Learning Representations.

<a id="2">[2]</a> 
Nichol, A., Dhariwal, P., Ramesh, A., Shyam, P., Mishkin, P., McGrew, B., Sutskever, I., & Chen, M. (2021). GLIDE: Towards Photorealistic Image Generation and Editing with Text-Guided Diffusion Models. International Conference on Machine Learning.

## Acknowledgements
The authors would like to thank the authors of ... for making their code publicly available.
